# Interactive Penetration Testing Suite

Sistema completo de testes de seguranÃ§a interativo com Selenium, Proxy nativo e testes via Console JavaScript.

## ğŸ¯ Componentes

### 1. Interactive Selenium Tester
Plugin interativo que permite testar vulnerabilidades em tempo real usando hotkeys.

### 2. Native Proxy
Proxy HTTP/HTTPS nativo para interceptaÃ§Ã£o e anÃ¡lise de requisiÃ§Ãµes.

### 3. Console Tester
Executor de testes JavaScript via console do navegador.

### 4. Integrated Suite
Sistema integrado que combina todos os mÃ³dulos.

---

## ğŸ“¦ InstalaÃ§Ã£o

```bash
# DependÃªncias Python
pip install selenium pynput beautifulsoup4 requests

# WebDriver (Chrome)
# Download: https://chromedriver.chromium.org/

# WebDriver (Firefox)
# Download: https://github.com/mozilla/geckodriver/releases
```

---

## ğŸ® Interactive Selenium Tester

### Recursos

- âœ… **Hotkeys para testes rÃ¡pidos**
  - `Ctrl + I` - SQL Injection
  - `Ctrl + X` - XSS
  - `Ctrl + L` - LFI (Local File Inclusion)
  - `Ctrl + C` - Console Test
  - `Ctrl + Q` - Sair

- âœ… **Feedback visual no browser**
  - NotificaÃ§Ãµes em tempo real
  - Highlight de elementos
  - Alertas de vulnerabilidades

- âœ… **Testes automÃ¡ticos**
  - SQL Injection (11 payloads)
  - XSS (10 payloads)
  - LFI (6 payloads)

### Uso BÃ¡sico

```bash
# Modo interativo simples
python3 plugins/interactive-testing/selenium_interactive/selenium_interactive.py https://example.com

# Com opÃ§Ãµes
python3 plugins/interactive-testing/selenium_interactive/selenium_interactive.py \
    https://example.com \
    '{"browser": "chrome", "proxy_enabled": false}'
```

### Fluxo de Trabalho

1. **Abra o plugin** - O navegador abrirÃ¡ automaticamente
2. **Navegue pelo site** - Interaja normalmente com a aplicaÃ§Ã£o
3. **Clique em um input** - Selecione o campo que deseja testar
4. **Pressione hotkey** - Use Ctrl+I, Ctrl+X ou Ctrl+L
5. **Aguarde os testes** - O plugin testarÃ¡ automaticamente
6. **Veja os resultados** - NotificaÃ§Ãµes aparecerÃ£o no browser

### Exemplo PrÃ¡tico

```python
# Testando formulÃ¡rio de login
# 1. Abra o plugin
# 2. Navegue atÃ© https://vulnerable-site.com/login
# 3. Clique no campo "username"
# 4. Pressione Ctrl+I (SQL Injection)
# 5. O plugin testarÃ¡ 11 payloads automaticamente
# 6. Se houver vulnerabilidade, vocÃª verÃ¡ alerta vermelho
```

### NotificaÃ§Ãµes

O plugin mostra notificaÃ§Ãµes coloridas:

- ğŸŸ  **Laranja:** "ğŸ” Testing SQL Injection..."
- ğŸ”´ **Vermelho:** "âš ï¸ SQL Injection vulnerability detected!"
- ğŸŸ¢ **Verde:** "âœ“ No SQL Injection detected"

---

## ğŸŒ Native Proxy

### Recursos

- âœ… HTTP/HTTPS support
- âœ… InterceptaÃ§Ã£o de requisiÃ§Ãµes/respostas
- âœ… AnÃ¡lise automÃ¡tica de vulnerabilidades
- âœ… Logging em JSON
- âœ… EstatÃ­sticas detalhadas

### Uso BÃ¡sico

```bash
# Proxy na porta padrÃ£o (8888)
python3 proxy/pentest_proxy.py

# Porta customizada
python3 proxy/pentest_proxy.py 9999

# Com opÃ§Ãµes
python3 proxy/pentest_proxy.py 8888 '{
    "verbose": true,
    "analyze": true,
    "save": true,
    "log_file": "my_proxy.json"
}'
```

### Configurar Browser

**Chrome:**
```
Settings â†’ Advanced â†’ System â†’ Open proxy settings
HTTP Proxy: 127.0.0.1:8888
HTTPS Proxy: 127.0.0.1:8888
```

**Firefox:**
```
Settings â†’ Network Settings â†’ Manual proxy configuration
HTTP Proxy: 127.0.0.1 Port: 8888
HTTPS Proxy: 127.0.0.1 Port: 8888
â˜‘ Also use this proxy for HTTPS
```

**Selenium (automÃ¡tico):**
```python
options = ChromeOptions()
options.add_argument('--proxy-server=127.0.0.1:8888')
driver = webdriver.Chrome(options=options)
```

### DetecÃ§Ã£o AutomÃ¡tica

O proxy detecta automaticamente:

**Requests:**
- SQL Injection attempts
- XSS payloads
- Sensitive data in URL (passwords, tokens, keys)

**Responses:**
- Private keys exposed
- Passwords in response
- Missing security headers (HSTS, CSP, X-Frame-Options, etc.)
- Error messages (SQL errors, stack traces)
- Potential tokens/secrets

### Output

```json
{
  "statistics": {
    "total_requests": 150,
    "total_responses": 145,
    "methods": {
      "GET": 120,
      "POST": 30
    },
    "vulnerabilities_found": 5
  },
  "vulnerabilities": [
    {
      "type": "missing_security_header",
      "severity": "low",
      "header": "X-Frame-Options",
      "description": "Clickjacking protection missing"
    }
  ]
}
```

---

## ğŸ”¬ Console Tester

### Recursos

- âœ… **Testes predefinidos:**
  - CORS vulnerabilities
  - API enumeration
  - Fetch API testing
  - DOM-based XSS
  - Storage analysis (localStorage, sessionStorage, cookies)
  - Cookie security
  - CSP (Content Security Policy)
  - API fuzzing

- âœ… **Modo interativo**
- âœ… **ExecuÃ§Ã£o de JavaScript customizado**

### Uso BÃ¡sico

```bash
# Todos os testes automÃ¡ticos
python3 console-testing/console_tester.py https://example.com

# Modo interativo
python3 console-testing/console_tester.py https://example.com '{"interactive": true}'

# Headless
python3 console-testing/console_tester.py https://example.com '{"headless": true}'
```

### Modo Interativo

```bash
$ python3 console-testing/console_tester.py https://example.com '{"interactive": true}'

JS> document.title
"Example Site"

JS> fetch('/api/users').then(r => r.json())
[{id: 1, name: "Alice"}, ...]

JS> run cors
{test: "CORS", vulnerable: true, ...}

JS> run api_enum
{test: "API_Enumeration", found: [...], count: 5}

JS> localStorage.getItem('token')
"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."

JS> quit
```

### Testes DisponÃ­veis

#### 1. CORS Test
```javascript
// Testa vulnerabilidades CORS
// Verifica se o site aceita requests de origens diferentes
run cors
```

#### 2. API Enumeration
```javascript
// Enumera endpoints API comuns
// /api, /api/v1, /users, /admin, etc.
run api_enum
```

#### 3. Fetch API Test
```javascript
// Testa autenticaÃ§Ã£o, mÃ©todos HTTP, rate limiting
run fetch_test
```

#### 4. DOM XSS Test
```javascript
// Detecta sources/sinks perigosos para XSS baseado em DOM
run xss_dom
```

#### 5. Storage Analysis
```javascript
// Analisa localStorage, sessionStorage, cookies
// Detecta dados sensÃ­veis
run local_storage
```

#### 6. Cookie Security
```javascript
// Verifica seguranÃ§a de cookies
// HttpOnly, Secure, SameSite
run cookie_test
```

#### 7. CSP Test
```javascript
// Analisa Content Security Policy
run csp_test
```

#### 8. API Fuzzing
```javascript
// Fuzz parÃ¢metros com payloads de SQLi, XSS, etc.
run api_fuzzing
```

### Scripts Personalizados

```javascript
// Testar API especÃ­fica
JS> fetch('/api/admin', {method: 'GET', credentials: 'include'})
    .then(r => r.json())
    .then(data => console.log(data))

// Manipular DOM
JS> document.querySelectorAll('input[type="password"]').forEach(i => {
      console.log(i.name, i.value);
    })

// Testar WebSocket
JS> const ws = new WebSocket('wss://example.com/socket');
    ws.onmessage = e => console.log('Received:', e.data);
    ws.send(JSON.stringify({type: 'test'}));
```

---

## ğŸš€ Integrated Suite

Combina todos os mÃ³dulos em um sistema unificado.

### Uso BÃ¡sico

```bash
# Modo interativo com proxy
python3 integrated_pentest.py https://example.com --mode interactive --proxy

# Apenas console tests
python3 integrated_pentest.py https://example.com --mode console

# Suite completa (console + interactive)
python3 integrated_pentest.py https://example.com --mode full --proxy

# Customizado
python3 integrated_pentest.py https://example.com \
    --mode full \
    --proxy \
    --proxy-port 9999 \
    --browser firefox \
    --output results.json
```

### OpÃ§Ãµes

```
--mode {interactive,console,full}
    Testing mode (default: interactive)

--proxy
    Enable proxy server

--proxy-port PORT
    Proxy port (default: 8888)

--browser {chrome,firefox}
    Browser to use (default: chrome)

--headless
    Run browser in headless mode

--interactive-console
    Enable interactive console mode

--output FILE
    Output file for results (default: pentest_results.json)
```

### Modo Full

Executa testes em duas fases:

**Fase 1: Console Tests**
- Testa CORS, API enum, storage, etc.
- Executa em background
- Coleta informaÃ§Ãµes iniciais

**Fase 2: Interactive Mode**
- Abre browser para testes manuais
- Usa hotkeys para testes especÃ­ficos
- Permite exploraÃ§Ã£o interativa

### Output

```json
{
  "target": "https://example.com",
  "mode": "full",
  "proxy_enabled": true,
  "results": {
    "console": {
      "tests": [...],
      "vulnerabilities": [...]
    },
    "interactive": {
      "tests_performed": [...],
      "vulnerabilities": [...]
    }
  }
}
```

---

## ğŸ“ CenÃ¡rios de Uso

### 1. Bug Bounty Hunting

```bash
# 1. Inicie o proxy para logging
python3 proxy/pentest_proxy.py 8888 &

# 2. Execute console tests para recon
python3 console-testing/console_tester.py https://target.com

# 3. Modo interativo para testes manuais
python3 plugins/interactive-testing/selenium_interactive/selenium_interactive.py \
    https://target.com '{"proxy_enabled": true}'

# 4. Use hotkeys para testar inputs especÃ­ficos
# Ctrl+I, Ctrl+X, Ctrl+L em campos suspeitos

# 5. Revise proxy log para requests/responses
cat proxy_log.json
```

### 2. Pentest RÃ¡pido

```bash
# Suite completa com proxy
python3 integrated_pentest.py https://target.com \
    --mode full \
    --proxy \
    --output pentest_report.json

# Revise resultados
cat pentest_report.json | jq '.results.console.vulnerabilities'
```

### 3. API Testing

```bash
# Console tests focados em API
python3 console-testing/console_tester.py https://api.target.com \
    '{"interactive": true}'

# No modo interativo:
JS> run api_enum
JS> run fetch_test
JS> run api_fuzzing

# Teste endpoint especÃ­fico
JS> fetch('/api/admin/users', {
      method: 'DELETE',
      headers: {'Authorization': 'Bearer token'}
    }).then(r => r.json())
```

### 4. AnÃ¡lise de Storage

```bash
# Teste storage e cookies
python3 console-testing/console_tester.py https://target.com

# Ou interativo:
JS> run local_storage
JS> run cookie_test

# Manual:
JS> Object.keys(localStorage).forEach(k => {
      console.log(k + ':', localStorage.getItem(k));
    })
```

### 5. Testing com AutenticaÃ§Ã£o

```bash
# 1. Inicie interactive mode
python3 plugins/interactive-testing/selenium_interactive/selenium_interactive.py \
    https://target.com

# 2. FaÃ§a login manualmente no browser
# 3. Navegue atÃ© Ã¡rea autenticada
# 4. Use hotkeys para testar funcionalidades autenticadas
# 5. Ctrl+C para executar testes via console com cookies de sessÃ£o
```

---

## ğŸ”§ ConfiguraÃ§Ã£o AvanÃ§ada

### Combo: Selenium + Proxy + Console

```python
# Script customizado
from selenium import webdriver
from selenium.webdriver.chrome.options import Options

# Start proxy (terminal 1)
# python3 proxy/pentest_proxy.py 8888

# Configure Selenium com proxy
options = Options()
options.add_argument('--proxy-server=127.0.0.1:8888')
driver = webdriver.Chrome(options=options)

# Navegar
driver.get('https://example.com')

# Executar console tests
result = driver.execute_script("""
    return fetch('/api/users')
        .then(r => r.json())
        .catch(e => ({error: e.message}));
""")

print(result)

# Todo o trÃ¡fego estarÃ¡ no proxy log
```

### Testes Customizados

```python
# selenium_interactive.py - adicionar teste customizado

def test_custom_vulnerability(self, element):
    """Teste personalizado"""
    print("[*] Testing custom vulnerability...")

    payloads = [
        "custom_payload_1",
        "custom_payload_2"
    ]

    for payload in payloads:
        element.clear()
        element.send_keys(payload)
        # ... lÃ³gica de teste

# Adicionar hotkey
# Ctrl + M = teste customizado
if key.char == 'm':
    threading.Thread(target=self.handle_custom_test).start()
```

---

## ğŸ“Š AnÃ¡lise de Resultados

### Proxy Log

```bash
# Ver estatÃ­sticas
cat proxy_log.json | jq '.statistics'

# Ver vulnerabilidades
cat proxy_log.json | jq '.vulnerabilities'

# Filtrar por tipo
cat proxy_log.json | jq '.vulnerabilities[] | select(.type == "sqli_attempt")'

# Top hosts
cat proxy_log.json | jq '.statistics.hosts | to_entries | sort_by(.value) | reverse'
```

### Interactive Results

```bash
# Ver vulnerabilidades encontradas
cat pentest_results.json | jq '.results.interactive.vulnerabilities'

# Contar por tipo
cat pentest_results.json | jq '
    .results.interactive.vulnerabilities |
    group_by(.type) |
    map({type: .[0].type, count: length})
'
```

### Console Results

```bash
# Testes executados
cat pentest_results.json | jq '.results.console.tests[].description'

# Vulnerabilidades por severidade
cat pentest_results.json | jq '
    .results.console.vulnerabilities |
    group_by(.severity) |
    map({severity: .[0].severity, count: length})
'
```

---

## ğŸ›¡ï¸ Melhores PrÃ¡ticas

### 1. Sempre use em ambientes autorizados
```
âš ï¸  NUNCA teste sites sem permissÃ£o explÃ­cita
âœ…  Bug bounty programs
âœ…  Seus prÃ³prios sites/apps
âœ…  Ambientes de teste
âœ…  LaboratÃ³rios (DVWA, bWAPP, etc.)
```

### 2. Configure rate limiting
```python
# Para evitar sobrecarga do servidor
options = {
    'delay': 1.0,  # 1 segundo entre testes
    'timeout': 10  # timeout de 10 segundos
}
```

### 3. Salve evidÃªncias
```bash
# Screenshots automÃ¡ticos
options = {"screenshot": true}

# Logs detalhados
options = {"verbose": true, "save": true}
```

### 4. Teste incrementalmente
```
1. Reconhecimento (console tests)
2. Testes automÃ¡ticos (integrated suite)
3. ExploraÃ§Ã£o manual (interactive mode)
4. Exploits especÃ­ficos (custom scripts)
```

---

## ğŸ› Troubleshooting

### WebDriver nÃ£o encontrado
```bash
# Chrome
wget https://chromedriver.storage.googleapis.com/LATEST_RELEASE
# Baixar versÃ£o correspondente

# Firefox
wget https://github.com/mozilla/geckodriver/releases/latest
```

### Proxy nÃ£o funciona
```bash
# Verificar se porta estÃ¡ livre
lsof -i :8888

# Testar proxy manualmente
curl -x 127.0.0.1:8888 http://example.com
```

### Selenium timeout
```python
# Aumentar timeout
from selenium.webdriver.support.ui import WebDriverWait

wait = WebDriverWait(driver, 30)  # 30 segundos
```

### pynput nÃ£o funciona
```bash
# Linux: instalar dependÃªncias
sudo apt-get install python3-xlib

# Mac: dar permissÃµes de acessibilidade
# System Preferences â†’ Security & Privacy â†’ Accessibility
```

---

## ğŸ“š ReferÃªncias

- [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)
- [Selenium Documentation](https://www.selenium.dev/documentation/)
- [Web Security Academy](https://portswigger.net/web-security)
- [HackerOne](https://www.hackerone.com/)

---

## âš–ï¸ Disclaimer

Esta suite Ã© para fins educacionais e testes autorizados apenas. O uso nÃ£o autorizado contra sistemas de terceiros Ã© ilegal. Use de forma responsÃ¡vel.

---

## ğŸ‰ Happy Hacking!

Para suporte, abra uma issue no repositÃ³rio ou consulte a documentaÃ§Ã£o adicional.
